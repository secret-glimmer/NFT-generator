from unittest.mock import patch

from src.common.validate import validate_config


@patch("os.path.isfile", return_value=True)
def test_floating_point_errors(mock_isfile):
    valid_config = {
        "layers": [
            {
                "name": "Background",
                "values": [
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "2.5.png",
                    "1.4.png",
                    "1.7.png",
                    "9.2.png",
                    "2.5.png",
                    "1.4.png",
                    "0.3.png",
                    "1.7.png",
                    "1.7.png",
                    "1.2.png",
                    "0.7.png",
                    "1.4.png",
                    "0.9.png",
                    "1.4.png",
                    "1.7.png",
                    "0.5.png",
                    "1.7.png",
                    "1.4.png",
                    "0.2.png",
                    "1.png",
                    "2.2.png",
                    "1.7.png",
                    "1.8.png",
                    "1.4.png",
                    "1.7.png",
                    "1.4.png",
                    "1.7.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.7.png",
                    "1.7.png",
                    "1.8.png",
                    "1.7.png",
                    "1.4.png",
                    "1.4.png",
                    "1.7.png",
                    "2.png",
                    "0.7.png",
                    "1.8.png",
                    "0.9.png",
                    "1.8.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.7.png",
                    "1.7.png",
                    "1.8.png",
                    "1.7.png",
                    "1.png",
                    "1.7.png",
                    "1.4.png",
                    "0.9.png",
                    "1.7.png",
                    "1.8.png",
                ],
                "trait_path": "./trait-layers/foreground",
                "filename": [
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "2.5.png",
                    "1.4.png",
                    "1.7.png",
                    "9.2.png",
                    "2.5.png",
                    "1.4.png",
                    "0.3.png",
                    "1.7.png",
                    "1.7.png",
                    "1.2.png",
                    "0.7.png",
                    "1.4.png",
                    "0.9.png",
                    "1.4.png",
                    "1.7.png",
                    "0.5.png",
                    "1.7.png",
                    "1.4.png",
                    "0.2.png",
                    "1.png",
                    "2.2.png",
                    "1.7.png",
                    "1.8.png",
                    "1.4.png",
                    "1.7.png",
                    "1.4.png",
                    "1.7.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.7.png",
                    "1.7.png",
                    "1.8.png",
                    "1.7.png",
                    "1.4.png",
                    "1.4.png",
                    "1.7.png",
                    "2.png",
                    "0.7.png",
                    "1.8.png",
                    "0.9.png",
                    "1.8.png",
                    "1.4.png",
                    "1.4.png",
                    "1.4.png",
                    "1.7.png",
                    "1.7.png",
                    "1.8.png",
                    "1.7.png",
                    "1.png",
                    "1.7.png",
                    "1.4.png",
                    "0.9.png",
                    "1.7.png",
                    "1.8.png",
                ],
                "weights": [
                    1.4,
                    1.4,
                    1.4,
                    1.4,
                    2.5,
                    1.4,
                    1.7,
                    9.2,
                    2.5,
                    1.4,
                    0.3,
                    1.7,
                    1.7,
                    1.2,
                    0.7,
                    1.4,
                    0.9,
                    1.4,
                    1.7,
                    0.5,
                    1.7,
                    1.4,
                    0.2,
                    1,
                    2.2,
                    1.7,
                    1.8,
                    1.4,
                    1.7,
                    1.4,
                    1.7,
                    1.4,
                    1.4,
                    1.4,
                    1.4,
                    1.4,
                    1.4,
                    1.4,
                    1.7,
                    1.7,
                    1.8,
                    1.7,
                    1.4,
                    1.4,
                    1.7,
                    2,
                    0.7,
                    1.8,
                    0.9,
                    1.8,
                    1.4,
                    1.4,
                    1.4,
                    1.7,
                    1.7,
                    1.8,
                    1.7,
                    1,
                    1.7,
                    1.4,
                    0.9,
                    1.7,
                    1.8,
                ],
            }
        ],
        "incompatibilities": [],
        "baseURI": ".",
        "name": "NFT #",
        "description": "This is a description for this NFT series.",
    }

    assert validate_config(valid_config) is None  # It should not raise an exception
